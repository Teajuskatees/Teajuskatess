<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Aplikasi Catatan Keuangan</title>
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQC..."/> 
  <!-- contoh favicon (base64 PNG), bisa ganti dengan file sendiri -->
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #4facfe, #00f2fe);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      background: #fff;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      width: 95%;
      max-width: 700px;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    input, select, button {
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 12px;
      font-size: 14px;
    }
    button {
      background: #4facfe;
      border: none;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #00c6ff;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 10px;
      text-align: center;
      border-bottom: 1px solid #ddd;
    }
    th {
      background: #f4f4f4;
    }
    .income {
      color: green;
      font-weight: bold;
    }
    .expense {
      color: red;
      font-weight: bold;
    }
    .saldo-box {
      margin-top: 15px;
      padding: 12px;
      text-align: center;
      background: #f4f4f4;
      border-radius: 12px;
      font-weight: bold;
      font-size: 16px;
    }
    .rekap {
      margin-top: 15px;
      padding: 12px;
      background: #e9f7ff;
      border-radius: 12px;
      font-size: 14px;
    }
    .hapus-btn {
      background: red;
      color: white;
      border: none;
      padding: 5px 8px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
    }
    .hapus-btn:hover {
      background: darkred;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ðŸ’° Catatan Keuangan</h2>
    <form id="form">
      <input type="text" id="deskripsi" placeholder="Deskripsi" required>
      <input type="number" id="jumlah" placeholder="Jumlah" required>
      <input type="date" id="tanggal" required>
      <select id="tipe">
        <option value="pemasukan">Pemasukan</option>
        <option value="pengeluaran">Pengeluaran</option>
      </select>
      <button type="submit">Tambah</button>
    </form>

    <table>
      <thead>
        <tr>
          <th>Tanggal</th>
          <th>Deskripsi</th>
          <th>Jumlah</th>
          <th>Tipe</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="tabel-body"></tbody>
    </table>

    <div class="saldo-box" id="saldo">Saldo: Rp 0</div>
    <div class="rekap" id="rekap-mingguan">Rekap Mingguan: Rp 0</div>
    <div class="rekap" id="rekap-bulanan">Rekap Bulanan: Rp 0</div>
  </div>

  <script>
    const form = document.getElementById("form");
    const deskripsi = document.getElementById("deskripsi");
    const jumlah = document.getElementById("jumlah");
    const tanggal = document.getElementById("tanggal");
    const tipe = document.getElementById("tipe");
    const tabelBody = document.getElementById("tabel-body");
    const saldoBox = document.getElementById("saldo");
    const rekapMingguan = document.getElementById("rekap-mingguan");
    const rekapBulanan = document.getElementById("rekap-bulanan");

    let saldo = 0;
    let transaksi = JSON.parse(localStorage.getItem("transaksi")) || [];

    form.addEventListener("submit", function(e) {
      e.preventDefault();

      const data = {
        id: Date.now(),
        desc: deskripsi.value,
        amount: parseInt(jumlah.value),
        type: tipe.value,
        date: new Date(tanggal.value)
      };

      transaksi.push(data);
      saveData();
      updateTabel();
      updateRekap();

      deskripsi.value = "";
      jumlah.value = "";
      tanggal.value = "";
      tipe.value = "pemasukan";
    });

    function saveData() {
      localStorage.setItem("transaksi", JSON.stringify(transaksi));
    }

    function hapusTransaksi(id) {
      transaksi = transaksi.filter(item => item.id !== id);
      saveData();
      updateTabel();
      updateRekap();
    }

    function updateTabel() {
      tabelBody.innerHTML = "";
      saldo = 0;

      transaksi.forEach(item => {
        const row = document.createElement("tr");

        const dateCell = document.createElement("td");
        const descCell = document.createElement("td");
        const amountCell = document.createElement("td");
        const typeCell = document.createElement("td");
        const aksiCell = document.createElement("td");

        dateCell.textContent = new Date(item.date).toLocaleDateString("id-ID");
        descCell.textContent = item.desc;
        amountCell.textContent = "Rp " + item.amount.toLocaleString();
        typeCell.textContent = item.type;

        if(item.type === "pemasukan") {
          amountCell.classList.add("income");
          saldo += item.amount;
        } else {
          amountCell.classList.add("expense");
          saldo -= item.amount;
        }

        const hapusBtn = document.createElement("button");
        hapusBtn.textContent = "Hapus";
        hapusBtn.className = "hapus-btn";
        hapusBtn.onclick = () => hapusTransaksi(item.id);

        aksiCell.appendChild(hapusBtn);

        row.appendChild(dateCell);
        row.appendChild(descCell);
        row.appendChild(amountCell);
        row.appendChild(typeCell);
        row.appendChild(aksiCell);

        tabelBody.appendChild(row);
      });

      saldoBox.textContent = "Saldo: Rp " + saldo.toLocaleString();
    }

    function updateRekap() {
      const now = new Date();
      const awalMinggu = new Date(now);
      awalMinggu.setDate(now.getDate() - now.getDay());
      const awalBulan = new Date(now.getFullYear(), now.getMonth(), 1);

      let totalMinggu = 0;
      let totalBulan = 0;

      transaksi.forEach(item => {
        const itemDate = new Date(item.date);
        if(itemDate >= awalMinggu && itemDate <= now) {
          totalMinggu += item.type === "pemasukan" ? item.amount : -item.amount;
        }
        if(itemDate >= awalBulan && itemDate <= now) {
          totalBulan += item.type === "pemasukan" ? item.amount : -item.amount;
        }
      });

      rekapMingguan.textContent = "Rekap Mingguan: Rp " + totalMinggu.toLocaleString();
      rekapBulanan.textContent = "Rekap Bulanan: Rp " + totalBulan.toLocaleString();
    }

    // Load awal
    updateTabel();
    updateRekap();
  </script>
</body>
</html>
